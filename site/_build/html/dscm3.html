
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DSC Multilingual Mystery #3: Quinn and Lee Clean Up Ghost Cat Data-Hairballs &#8212; The Data-Sitters Club</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="DSC Multilingual Mystery 4: Isabelle and the Missing Spaghetti-O’s" href="dscm4.html" />
    <link rel="prev" title="DSC Multilingual Mystery 2: Beware, Lee and Quinn!" href="dscm2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/DSClogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Data-Sitters Club</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter-2.html">
   About the DSC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="books.html">
   DSC Books
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Main series
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dsc1.html">
   DSC 1: Quinn's Great Idea
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc2.html">
   DSC 2: Katia and the Phantom Corpus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc3.html">
   DSC 3: The Truth About DH Collaboration (and Textual Variants!)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc4.html">
   DSC 4: AntConc Saves the Day
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc5.html">
   DSC 5: The DSC and the Impossible TEI Quandaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc6.html">
   DSC 6: Voyant's Big Day
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc7.html">
   DSC 7: The DSC and Mean Copyright Law
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc8.html">
   DSC 8: Text-Comparison-Algorithm-Crazy Quinn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc9.html">
   DSC 9: The Ghost in Anouk's Laptop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc10.html">
   DSC 10: Heather Likes PCA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc11.html">
   DSC 11: Katia and the Sentiment Snobs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc12.html">
   DSC 12: The DSC and the New Programming Language
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc13.html">
   DSC 13: Goodbye, Friends, Goodbye
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc14.html">
   DSC 14: Hello, DMCA Exemption!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dsc15.html">
   DSC 15: Little Miss California Stereotype... and the BY Times
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multilingual mysteries
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dscm1.html">
   DSCM 1: Lee and the Missing Metadata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dscm2.html">
   DSCM 2: Beware, Lee and Quinn!
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   DSCM 3: Quinn and Lee Clean Up Ghost Cat Data-Hairballs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dscm4.html">
   DSCM 4: Isabelle and the Missing Spaghetti-O's
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fun
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="covid19.html">
   Important Public Health Messages from the Data-Sitters Club about COVID-19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dhawards2019.html">
   DH Awards 2019 Ad Campaign
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/datasittersclub/site"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/dscm3.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dear-reader">
   Dear Reader
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap">
   Recap
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lee">
   Lee
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quinn">
   Quinn
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#web-scraping">
     Web scraping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-a-sitemap">
       Creating a sitemap
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#handling-selectors-easy-mode">
       Handling selectors: easy mode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scraping-and-exporting">
       Scraping and exporting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#just-the-urls">
       Just the URLs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scraping-all-the-things">
       Scraping ALL THE THINGS
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#got-ghost-cat-data-hairballs-call-openrefine">
     Got Ghost Cat Data-Hairballs? Call OpenRefine.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-getting-one-row-per-book-from-the-fan-wiki-data">
       Step 1: Getting One Row Per Book from the Fan Wiki Data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-clean-up-quebec-data">
       Step 2. Clean up Quebec data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-clean-up-the-data-from-the-french-national-library">
       Step 3. Clean up the data from the French National Library
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#look-both-ways-before-crossing-the-cells">
       Look both ways before crossing the cells
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-little-more-tidying">
       A little more tidying
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-4-revisiting-the-fan-wiki-data">
     Step 4. Revisiting the fan wiki data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-5-the-ultimate-cell-cross-of-ultimate-destiny">
     Step 5. The Ultimate Cell-Cross of Ultimate Destiny*
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#where-to-from-here">
     Where to from here?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#suggested-citation">
   Suggested citation
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>DSC Multilingual Mystery #3: Quinn and Lee Clean Up Ghost Cat Data-Hairballs</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dear-reader">
   Dear Reader
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recap">
   Recap
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lee">
   Lee
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quinn">
   Quinn
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#web-scraping">
     Web scraping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#creating-a-sitemap">
       Creating a sitemap
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#handling-selectors-easy-mode">
       Handling selectors: easy mode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scraping-and-exporting">
       Scraping and exporting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#just-the-urls">
       Just the URLs
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scraping-all-the-things">
       Scraping ALL THE THINGS
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#got-ghost-cat-data-hairballs-call-openrefine">
     Got Ghost Cat Data-Hairballs? Call OpenRefine.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-getting-one-row-per-book-from-the-fan-wiki-data">
       Step 1: Getting One Row Per Book from the Fan Wiki Data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-clean-up-quebec-data">
       Step 2. Clean up Quebec data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-clean-up-the-data-from-the-french-national-library">
       Step 3. Clean up the data from the French National Library
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#look-both-ways-before-crossing-the-cells">
       Look both ways before crossing the cells
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-little-more-tidying">
       A little more tidying
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-4-revisiting-the-fan-wiki-data">
     Step 4. Revisiting the fan wiki data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-5-the-ultimate-cell-cross-of-ultimate-destiny">
     Step 5. The Ultimate Cell-Cross of Ultimate Destiny*
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#where-to-from-here">
     Where to from here?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#suggested-citation">
   Suggested citation
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <img src="_static/images/DSCLogo.png" />
<div class="tex2jax_ignore mathjax_ignore section" id="dsc-multilingual-mystery-3-quinn-and-lee-clean-up-ghost-cat-data-hairballs">
<h1>DSC Multilingual Mystery #3: Quinn and Lee Clean Up Ghost Cat Data-Hairballs<a class="headerlink" href="#dsc-multilingual-mystery-3-quinn-and-lee-clean-up-ghost-cat-data-hairballs" title="Permalink to this headline">#</a></h1>
<p>by Lee Skallerup Bessette and Quinn Dombrowski, April 2, 2020</p>
<div style="float: right; width: 300px;margin-left: 7px;margin-top: 0px;">
<img src="_static/images/bookcovers/dscm3_cover.jpg" alt="DSC M3 book cover" />
</div>
<div class="section" id="dear-reader">
<h2>Dear Reader<a class="headerlink" href="#dear-reader" title="Permalink to this headline">#</a></h2>
<p>Dear Reader,</p>
<p>We’ve been writing this Multilingual Mystery on and off for the last month. During that time, Lee performed non-stop heroics for the emergency shift to online instruction at Georgetown. Quinn finished teaching her Dungeons-and-Dragons style DH role-playing game course virtually, watching as COVID-19 disrupted the lives of the characters – and the students. For more than two weeks now, the Bay Area has been on lockdown, and Quinn has been running a preschool/kindergarten for three kids 6-and-under while trying to help non-English language and literature faculty at Stanford figure out what to do for spring quarter. Lee is also <a class="reference external" href="https://readywriting.org/working-from-home/">working from home with older kids</a>, and we’re both grappling with how to <a class="reference external" href="http://quinndombrowski.com/blog/2020/03/27/pandemic-parenting-pedagogy">manage what the school districts are putting together for K-12 virtual education</a>.</p>
<p>Throughout all of this, we kept coming back to writing this Data-Sitters Club “book”. We’ve had to go back and edit it in places (ballet classes are no longer happening), and we’ve felt moments of estrangement from words written less than a month before. There’s been nights when we’ve been <a class="reference external" href="http://quinndombrowski.com/blog/2020/03/21/working-conditions">too exhausted to do anything else</a>, but this project has been a reassuring distraction. The topics – data downloading, web scraping, and data cleaning – may seem dry and technical, but in this strange time there’s something comforting about writing up how to have control over <em>something</em>… even if it’s just text on a screen.</p>
<p>We hope it brings you some comfort, too. If you can put it to use in some way that helps other people, so much the better – whether it’s gathering data about hiring freezes, dubious government statements, or 80’s/90’s cultural phenomena that might bring a smile to someone’s face in a dark time. And if you’re not in the mental space right now to tackle it, that’s okay too. It’ll be here for you when the time is right.</p>
<p>Take care,</p>
<p>Quinn &amp; Lee</p>
<p>P.S. If you want a laugh, check out our ongoing series of <a class="reference external" href="http://datasittersclub.github.io/site/covid19">Important Public Health Messages from the Data-Sitters Club</a>.</p>
</div>
<div class="section" id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">#</a></h2>
<p>When we left off with <a class="reference external" href="https://datasittersclub.github.io/site/dscm2/">DSC Multilingual Mystery #2</a>, we had realized that metadata is going to be essential for just about anything we do with computational text analysis at scale for these translations. And in DSC #4 (forthcoming soon!), Anouk comes to the same conclusions about the original corpus in English. It was time to investigate metadata acquisition and cleaning, and the DSC Multilingual Mystery crew was on the case!</p>
</div>
<div class="section" id="lee">
<h2>Lee<a class="headerlink" href="#lee" title="Permalink to this headline">#</a></h2>
<p>As I mentioned in the <a class="reference external" href="https://datasittersclub.github.io/site/dscm1/">DSC Multilingual Mystery #1</a>, I already had a pretty good working idea about where to get the metadata we needed to be able to identify translators and other publication data for the various foreign-language translations of the series: national libraries. And, I wasn’t wrong. The <a class="reference external" href="https://banq.qc.ca/accueil/">Bibliothèque et Archives nationales du Québec</a>, the <a class="reference external" href="https://www.bnf.fr/fr">Bibliothèque nationale de France</a>, the <a class="reference external" href="http://www.bne.es/es/Inicio/index.html">Biblioteca Nacional de España</a>, the <a class="reference external" href="https://www.bncf.firenze.sbn.it/">Biblioteca Nazionale Centrale di Firenze</a>, and the <a class="reference external" href="https://www.kb.nl/en">Koninklijke Bibliotheek</a> provided me with all of the information we would need to get the information we required. Oh, and the five lonely German translations from <a class="reference external" href="https://www.dnb.de/EN/Home/home_node.html">Deutsche Nationalbibliothek</a>.</p>
<p>My methodology was simple: Google the country name and “national library.” Put Ann M. Martin in the search box (thank goodness for the universal language of user experience and expectations). If that didn’t work, find the word that most closely resembles “catalogue” and click on it to find a different search box. And then, the final and least simple of the steps: export the metadata.</p>
<p>This is where the inconsistencies arose, with each library offering its own idiosyncratic way of getting the metadata out of the library catalogue and into the hands of users. Quebec would only let me export a certain number of results from my search at a time as a csv file. I decided to limit my search by time period, as it was easiest to limit my searches in the interface that way. So, there are I had one CSV file for each year that the books were being published. France was the easiest to export, allowing me to download my entire search (which included the France and Belgium translations) as a giant CSV file. Spain let me export a page of results at a time as XML that displayed in my browser window, which I copied into a file. Shout-out to the Netherlands for having a functional English interface…and exporting the search as a simple text file. And then Italy…Italy made me cut and paste every single entry individually as XML as there was no batch export function.</p>
<p>All I gotta say is that y’all are lucky I love to solve a good mystery and that I only have the mental capacity for menial tasks while waiting during my daughter’s ballet class where I found myself sitting in the most uncomfortable seat imaginable while seven different dance studios practice five different dance styles, playing seven different songs repeatedly. Sigh. I never thought I’d say this, but I miss those days.</p>
<p>There was often the option to export the results as a simple text file, but the challenge was that simple text often didn’t preserve the accents on letters, becoming gibberish instead, making it difficult to understand the information and data. So, CSV and XML were the closest I could get to relatively universal readability, or at least the cleanest data I could get for Quinn. It wasn’t perfect, but it was a good first start. Also, the metadata you extract is only as good as the metadata contained in the book’s library entry, and apparently no one bothered in either France or Belgium to note who translated the first handful of Belgian-French translations of the books. So while I extracted all of the data that was available, there are still some mysteries that might only be solved by either looking at a physical copy of the books or reaching out to the publisher to see if they have preserved the archives or kept the records somewhere. More mysteries that maybe we’ll be able to someday solve if we’re ever allowed to leave our houses again (lol*sob).</p>
<p>I was also curious to see if there were other translations in common Romance languages, so I looked in national libraries in South America for other Spanish translations, as well as Brazil and Portugal for Portugese translations. I came up empty-handed, but it was worth it to look to see if there were any other translations in a language that I could recognize. Which brings up the next limitation in my search: I know English and French fluently, have six credits of university Spanish, and feel pretty comfortable given my knowledge of French and Spanish in navigating an Italian language library website. So while there are more translations, I didn’t feel like I was comfortable enough to rummage around in the national libraries of other languages.</p>
</div>
<div class="section" id="quinn">
<h2>Quinn<a class="headerlink" href="#quinn" title="Permalink to this headline">#</a></h2>
<p>I was amazed at what Lee managed to find in those national library catalog records. There it was: the answers to our question about the number of translations, and who most of the translators were! One beautiful thing about most national libraries, many museums, and various other online digital collections is that there’s often an option for just downloading your search or browsing results, which saves you a <em>ton of work</em> relative to trying to do web scraping to collect the same information. Before you embark on web scraping from any cultural heritage website, be sure to read the documentation and FAQs, Google around, and be extra, extra sure that there’s not an easier route to get the data directly. I’m not kidding: about half my “web scraping” consults at work have been resolved by me finding some kind of “download” button. Downloading the data isn’t everything, though: I knew that if we didn’t spend the time now to reorganize it into a consistent format that we could easily use to look things up and check for correlations (e.g. between translators and certain character-name inconsistencies), we’d definitely regret it later.</p>
<p>Now, it’s easy to go overboard with data cleaning. Sometimes my library degree gets the better of me, and I start organizing All The Things. (This in contrast to my usual inclination to just pile things in places and assume it’ll all sort itself out when the time is right.) With DH in particular, there’s a temptation to clean more than you need, and produce a beautiful data set that has all the information perfectly structured. It’s usually driven by altruism towards your future self or other scholars. “Someday, <em>someone might want this.</em>” And if the data is easy and quick to clean, there’s not much lost in that investment. But if it’s a gnarly problem, and your future use case is hypothetical, maybe it’s worth reconsidering whether it’s the best use of your time <em>right now</em>. If someone wants a clean version of that data in the future, it’s okay to let it be their problem. In the national library records that Lee found, there’s a lot of data like that. Would it be interesting to see the publication cities for all the translations? Sure! Would it be fun to look at differences in subject metadata? Absolutely! (I’m really tempted by that one, truth be told.) But the data for both of those is kind of annoying to clean, and not actually what we need to answer the questions we’re working on. Sometimes the hardest part of DH is setting aside all the things you <em>could do</em>, to finish the thing that you’re <em>actually doing</em>.</p>
<p>What I was <em>actually doing</em> was trying to get five pieces of information out of the data that Lee downloaded, for each book:</p>
<ol class="simple">
<li><p>The translated title of the book</p></li>
<li><p>A unique identifier to connect back to the original book (book number, title, etc.)</p></li>
<li><p>Which translation series is appears in (e.g. for French: Quebec, Belgium, or France)</p></li>
<li><p>The date it was published</p></li>
<li><p>The translator</p></li>
</ol>
<p>Anything else in these files – regardless of how many great ideas I had for what I might do with it – was a distraction.</p>
<p>But wait! We already started wondering about whether certain things we were finding were quirks of particular ghostwriters. This was the perfect time to scrape and clean a data set that could help us answer those kinds of questions, too. So before we get to cleaning, let’s see what else the Ghost Cat of Data-Sitters Club Multilingual Mystery #3 might grace us with, all over the carpet! (Sorry, readers – what can I say, we’re <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Mallory_and_the_Ghost_Cat">committed to fidelity to the original book titles</a>, however tortured it gets.)</p>
<p>If you want to follow along some of the steps, but not the whole thing, you can check out the <a class="reference external" href="https://github.com/datasittersclub/dscm3">GitHub repo for this book</a> for the data and configuration files we’re with here.</p>
<div class="section" id="web-scraping">
<h3>Web scraping<a class="headerlink" href="#web-scraping" title="Permalink to this headline">#</a></h3>
<p>I do a lot of web scraping. When I need to do something simple, quick, and relatively small-scale, I go with <a class="reference external" href="http://webscraper.io">webscraper.io</a>, even though it gives you less flexibility in structuring and exporting your results compared to Python. I knew the <a class="reference external" href="https://babysittersclub.fandom.com/wiki/The_Baby-Sitters_Club_Wiki">Baby-Sitters Club Wiki</a> on <a class="reference external" href="http://Fandom.com">Fandom.com</a> had the data I needed, presented as well-structured metadata on each book page. <a class="reference external" href="http://Webscraper.io">Webscraper.io</a> was going to be a good tool for this job.</p>
<p><a class="reference external" href="http://Webscraper.io">Webscraper.io</a> is a plugin for the Chrome browser, so first you need to <a class="reference external" href="https://webscraper.io/documentation/installation">install it from the Chrome store</a>. Next, you need to 1) access it in your browser by opening the <em>Developer Tools</em> panel, then 2) choose <em>Web Scraper</em> from the tabs at the top of the panel.</p>
<p><img alt="Launching the webscraper plugin" src="_images/dscm3_launchwebscraper.jpg" /></p>
<div class="section" id="creating-a-sitemap">
<h4>Creating a sitemap<a class="headerlink" href="#creating-a-sitemap" title="Permalink to this headline">#</a></h4>
<p>Using <a class="reference external" href="http://Webscraper.io">Webscraper.io</a>’s menu, go to <em>Create new sitemap &gt; Create sitemap</em>, as shown by arrow 3, above. (Note: if you want to import an existing sitemap, like one of the complete ones that we’ve posted at the <a class="reference external" href="https://github.com/datasittersclub/dscm3">Data-Sitters Club GitHub repo for this book</a>, you can choose “Import Sitemap” and copy and paste the text from the appropriate sitemap text file into the text field. If you run into trouble with the instructions here, importing one of our sitemaps and playing around with it might help you understand it better.)</p>
<p>The first page is where you put in the start URL of the page you want to scrape. If you’re trying to scrape multiple pages of data, and the site uses pagination that involves appending some page number to the end of the URL (e.g. if you go to the second page of results and you see the URL is the same except for something like <code class="docutils literal notranslate"><span class="pre">?page=2</span></code> on the end), you can set a range here, e.g. <a class="reference external" href="http://www.somesite.com/results?page=%5B1-5%5D">http://www.somesite.com/results?page=[1-5]</a> if there are 5 pages of results. In our case, though, we have eight <em>different</em> web pages we want to scrape for URLs, one for each book (sub-)series.</p>
<p>First, we’ll give our scraper a name (it can be almost anything; I went with <em>bsc_fan_wiki_link_scraper</em>). For the URL, I just put in the URL for the main book series, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:The_Baby-Sitters_Club_series">https://babysittersclub.fandom.com/wiki/Category:The_Baby-Sitters_Club_series</a>. If you have multiple pages (and especially if you’re putting in a range), it’s often best to start by putting in a single page, setting up the scraper, checking the results, and seeing if you need to make any modifications before you scrape hundreds of pages without capturing what you need. (Trust me – it’s a mistake I’ve made!)</p>
</div>
<div class="section" id="handling-selectors-easy-mode">
<h4>Handling selectors: easy mode<a class="headerlink" href="#handling-selectors-easy-mode" title="Permalink to this headline">#</a></h4>
<p>Web scraping is <em>a lot easier</em> if you know at least a little bit about HTML, how it’s structured, and some common elements. Especially once you get into Python-based web scraping, CSS becomes important, too. I was lucky enough to learn HTML in elementary school (my final project in the 5th grade was a Sailor Moon fan site, complete with starry page background and at least one <blink> element), so it’s hard for me to remember not knowing this stuff. But there’s lots of tutorials out there, like this one from <a class="reference external" href="https://www.w3schools.com/html/html_intro.asp">W3Schools</a>, that can get you up to speed with the basics and let you play around with it if you’re not really comfortable with HTML.</p>
<p>The way we set up a web scraper is related to the way HTML is structured: HTML is made up of nested elements, and if we’re doing something complex with our scraper, it’ll have a nested structure, too.</p>
<p>For our first scraper, we’re <em>just</em> trying to get the URLs of all the links on each page.</p>
<p>We’ll start by hitting the “Add new selector” button, which takes us to a different interface for choosing the selector. You have to give it a unique ID (I chose <em>pagelink</em>), then choose a type from the dropdown menu. For now, we just want <em>Link</em> for the type. Under the <em>Selector</em> header in this interface, check the “multiple” box (there are multiple links on the page), then click the “Select” button. Now the fun begins! Move your mouse back up to the page, and start clicking on the things you want to capture. After you’ve clicked on 2-3 of them, the scraper usually gets the idea and highlights the rest. In this case, I started clicking in the “A’s”, and after two clicks it picked up the rest of the entries filed under that letter, but I had to click in the results for a different letter before it picked up <em>everything</em>.</p>
<p><img alt="Selecting links for the scraper" src="_images/dscm3_selecting_links.jpg" /></p>
<p>When everything you want is highlighted in red, click the blue “Done selecting” button. What I then had was <code class="docutils literal notranslate"><span class="pre">ul:nth-of-type(n+3)</span> <span class="pre">a.category-page__member-link</span></code>. If you’re not comfortable with HTML, you might just be relieved that the computer sorted out all <em>that</em> mess. But if you know how to read this, you should be concerned. <code class="docutils literal notranslate"><span class="pre">&lt;ul&gt;</span></code> means “unordered list” (typically, but not always, looks like a bullet point list), and we’re grabbing the 3rd &gt;ul&lt; on the page. Which, yes, is what we selected: by starting with A on the <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:The_Baby-Sitters_Club_series">regular book series page</a>, we’re skipping the list with character-based category pages, and the erroneous list where a wiki page name starts with the number 3. If we were just scraping this one page, it’d be fine: we’d get what we selected, which – deliberately – is not <em>every link on the page</em>. But what about the Super Specials, Mysteries, Super Mysteries, etc? If we start with the third list, will we be missing things?</p>
<p>Take it from someone who’s had to scrape (and re-scrape, and re-re-scrape) a Russian Harry Potter fanfic archive multiple times after not being careful enough: it’s almost always better to scrape <em>too much stuff</em> and have to do some cleaning later, than to <em>not scrape enough stuff</em> and have to re-do it, especially if you don’t notice until after you’ve spent a lot of time cleaning up Ghost Cat data-hairballs.</p>
<p>What to do? Well, <code class="docutils literal notranslate"><span class="pre">:nth-of-type(n+3)</span></code> is a modifier on <em>ul</em>, so you can drop it to get ALL THE UNORDERED LISTS. But actually, you can go one step further and even get rid of the <em>ul</em> part, because what you’re actually grabbing *isn’*t unordered lists, but <em>links</em> (in HTML, &lt;a&gt; for anchor) that have the class <code class="docutils literal notranslate"><span class="pre">category-page__member-link</span></code>. The period after the a in the selector indicates a class attribute, which you can see if you switch from the “Web Scraper” tab to the “Elements” tab in the developer toolbar.</p>
<p><img alt="HTML page view" src="_images/dscm3_html_view.jpg" /></p>
<p>Each link corresponds to HTML that looks something like: <code class="docutils literal notranslate"><span class="pre">&lt;a</span> <span class="pre">href=&quot;/wiki/Abby_and_the_Best_Kid_Ever&quot;</span> <span class="pre">title=&quot;Abby</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">Best</span> <span class="pre">Kid</span> <span class="pre">Ever&quot;</span> <span class="pre">class=&quot;category-page__member-link&quot;&gt;Abby</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">Best</span> <span class="pre">Kid</span> <span class="pre">Ever&lt;/a&gt;</span></code>. The text <em>Abby and the Best Kid Ever</em> (the one that occurs between <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>) is the text that actually appears on the page. The rest is the HTML instructions used to make that text into a link. But not just any link: a link with the class category-page__member-link, which <em>only</em> appears with links that are part of this list of books in the series corresponding to this wiki page (Regular, Mystery, etc.) Those are the links you want. To select &lt;a&gt; tags with the class category-page_member-link, click in the selector text box that reads ul:nth-of-type(n+3) a.category-page_member-link, and delete everything before the <em>a</em>.</p>
<p>One good way to make sure you’re generally getting what you want is to click the “Data preview” button once you have something in the selection box. What you should see is all the URLs and link titles on the page, along with a _<em>followSelectorId</em> field that has the value of pagelink for all the links (i.e. the name you gave the link selector when you created it). What we actually <em>need</em> is just the URLs, so the rest is Ghost Cat hairball, but there’s no easy way to get <em>only</em> what we need using the <a class="reference external" href="http://Webscraper.io">Webscraper.io</a> plugin, so we’ll take it all and clean it up later.</p>
<p><img alt="Previewing data" src="_images/dscm3_data_preview.png" /></p>
<p>Click the blue <em>Save selector</em> button at the bottom of the interface.</p>
</div>
<div class="section" id="scraping-and-exporting">
<h4>Scraping and exporting<a class="headerlink" href="#scraping-and-exporting" title="Permalink to this headline">#</a></h4>
<p>Now it’s time to do the scraping. In the <a class="reference external" href="http://webscraper.io">webscraper.io</a> interface, go to <em>Sitemap bsc_fan_wiki_link_scraper &gt; Scrape</em>. The window that pops up has two options: Request interval and Page load delay. Request interval means how long to wait before asking the website’s server for a new page, assuming there’s more than one page. The thing is, if you hammer a server with requests, you’re asking to get throttled: having your requests slowed…. way … waaayyyyyyyy…. down. It’s the price you pay for not having good web scraping manners. 5 seconds (5000 ms) is probably a good place to start, but if you’re doing scraping at scale (tens or hundreds of pages), you still might be throttled as a bot (which, let’s face it, you kinda are) if your delay is the same every time. (We can do more sophisticated things by writing a scraper in Python that can get around some of those issues, but that’s a guide for another DSC book.) In this case, though, where we only have a few pages to scrape, the default is fine. As for <em>Page load delay</em>, if you have a slow connection, or are scraping a complex site that takes some time to load, you may want to increase this value. If you want to guesstimate how much it should be, time a few page loads (from the new page appearing on your screen, to everything being loaded) by pulling up pages in your browser.</p>
<p>Click the blue “Start scraping” button. A new browser window will pop open with the page(s) that you’re scraping; don’t close it, it’ll close itself when it’s done.</p>
<p>When the window closes itself, it’ll take you to a page that says “No data scraped”; hit the blue “Refresh” button and your data will appear. Then go to <em>Sitemap bsc_fan_wiki_link_scraper &gt;  Export data as CSV</em>. On that page, click the <em>Download now!</em> link, and you’ll download a CSV file.</p>
<p><img alt="Downloading a CSV" src="_images/dscm3_download_csv.png" /></p>
<p>If you want to edit your scraper to include multiple pages, go to <em>Sitemap bsc_fan_wiki_link_scraper &gt; Edit metadata</em>. There’s a + button on the right side of the URL field, and you can use it to put in more than one page (e.g. adding the URLs for <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Mystery_books">Mysteries</a>, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Super_Special_books">Super Specials</a>, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Super_mysteries">Super Mysteries</a>, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Portrait_Collection_books">Portrait Collection</a>, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:California_Diaries_series">California Diaries</a>, <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Readers%27_Request_books">Reader Requests</a>, and <a class="reference external" href="https://babysittersclub.fandom.com/wiki/Category:Friends_Forever_series">Friends Forever</a>). Then, just re-scrape and re-download.</p>
</div>
<div class="section" id="just-the-urls">
<h4>Just the URLs<a class="headerlink" href="#just-the-urls" title="Permalink to this headline">#</a></h4>
<p>We could import this CSV into OpenRefine, but honestly, it’s faster and easier to pull the CSV into Google Docs or Excel, delete the stray rows (e.g. Category:Jessi books), and copy only the <em>pagelink-href</em> column (which has the URLs). At this scale (fewer than 300 rows), it probably makes the most sense to just skim and do this cleanup manually, but if you search for “Category” (which will give you links that just take you to sub-categories, like “Mallory Books”), and “Karen” (which is a giveaway for books in the “Baby-Sitter’s Little Sister” book series, about Kristy’s super-annoying step-sister Karen), that should help you flag the bigger sets of bad results. There’s also random pages that accidentally got mis-tagged (e.g. at least as of when I’m writing this, “How to cosplay as Stacey McGill from the BSC”), so you do actually need to read through the list with your eyeballs, and check on any page titles where you’re unsure. You should also de-duplicate links as needed, so that you only have one copy of each link (e.g. “Stacey and the Haunted Masquerade” was tagged with both the regular series and mystery, so it appears twice.) Sorting the URLs alphabetically should help make these visible, and most spreadsheet software can easily replace duplicates automatically. (If you’re using Google Sheets, you can just go to <em>Data &gt; Remove</em> duplicates to take care of it.)</p>
<p>All together, you should have 229 links to scrape.</p>
</div>
<div class="section" id="scraping-all-the-things">
<h4>Scraping ALL THE THINGS<a class="headerlink" href="#scraping-all-the-things" title="Permalink to this headline">#</a></h4>
<p>You <em>could</em> load those 229 pages into <a class="reference external" href="http://Webscraper.io">Webscraper.io</a> by hitting the + button on the URL field 228 times, and no doubt you may be tempted, especially if you’re delegating this work to a research assistant. But resist the tantalizing purr of the Ghost Cat leading you down the path to rote labor: there’s an easier way.</p>
<p>What you need is a web page with all the links you want to scrape (as HTML links, not just plain text). The easiest way to get there, as of March 2020, is to use a site like <a class="reference external" href="https://pastelink.net/">pastelink.net</a>, where you can paste the URLs from the spreadsheet you cleaned up in the last step, and it’ll give you a link that you can use for <a class="reference external" href="http://Webscraper.io">Webscraper.io</a>. The site has been around since at least 2015, though it seems at least moderately sketchy (their “news and updates” page mentions a successful purge of child abuse links in 2018 😬), and it can’t handle URLs that have an exclamation mark at the end (as more than a couple BSC books do – along with their corresponding wiki pages), but it’s your easiest option if you’re not comfortable making an HTML or Markdown page.</p>
<p>A less-dodgy alternative, if you have a GitHub account and are comfortable with Markdown or HTML, is to create a file in a GitHub repo as a place to put the URLs. This approach makes it possible to make all the URLs work, even if they end in an exclamation mark. To make a <a class="reference external" href="https://github.com/datasittersclub/dscm3/blob/master/bsc_wiki_links.md">Markdown file that you can put on GitHub (like we’ve done here)</a>, try this: if you copy and paste the list of URLs, one URL per line into a plain-text editor that supports regular expressions (which you can <a class="reference external" href="https://programminghistorian.org/en/lessons/understanding-regular-expressions">read up on at The Programming Historian</a> – they’re basically a fancy find-and-replace syntax), you can search for <code class="docutils literal notranslate"><span class="pre">^(.*)$</span></code> (which translates to “grab all the characters from the beginning of the line to the end of the line”) and replace it with <code class="docutils literal notranslate"><span class="pre">[$1]($1)</span></code> (“put what you grabbed between square brackets, then between parentheses”), though you may need to check your text editor documentation for whether its flavor of regular expressions uses $1 or \1 or some other notation for captured groups. If you get this to work, save the results as a .md file, and push that file to a GitHub repo, you can use the URL for that Markdown file in the next step (just like we’ve done, <a class="reference external" href="https://github.com/datasittersclub/dscm3/blob/master/bsc_wiki_links.md">using our wiki links Markdown file</a> in our <a class="reference external" href="https://github.com/datasittersclub/dscm3/blob/master/bsc_book_metadata.txt">book metadata scraper</a>).</p>
<p>However you put your list of links online, the next step is to create a new sitemap in <a class="reference external" href="http://webscraper.io">webscraper.io</a>, and put the URL <em>of the page with all your links</em>, not any of the individual links. Then, the first selector in the sitemap that you create should be set to have multiple values, and what you’re selecting for is each of the links on the page.</p>
<p><img alt="Selecting all the links" src="_images/dscm3_linkselector.jpg" /></p>
<p>Once you’ve saved that selector, click on it in your sitemap. This takes you <em>inside</em> that selector, as <a class="reference external" href="http://Webscraper.io">Webscraper.io</a> structures things. The new selectors you add aren’t selectors for your page of links, they’re selectors for the <em>pages whose URLs are on that page of links</em>. For that reason, it’s going to be very helpful if the links in a single list go to pages that are pretty homogenous: you want the nested selectors to be applicable to most or all of those pages. Not all the selectors I created here work for every book (e.g. the California Diaries and Portrait books don’t really have book numbers), but most of the fields are relevant across the board.</p>
<p>As an important side note here, wikis hosted on <a class="reference external" href="http://fandom.com">fandom.com</a> are <em>unusually well-structured</em> and pretty remarkable for their use of semantically-inflected markup (i.e. a lot of the HTML elements include a class – as we’ve seen above – that tells you something about the content that you’ll find inside). Compare, even, to Wikipedia: even though you have what looks like structured metadata in the sidebar boxes for most articles, if you inspect the HTML, you’ll find a table with the class “infobox”, and then a bunch of table rows (<tr>) and cells (<td>). What if you were reading the news and wanted to, say, set up a scraper that would go to the Wikipedia page for a bunch of different historical pandemics and extract the death toll? Good luck!</p>
<p>Probably the best you could do is capture the whole sidebar table, and try to (as likely as not, manually) extract the number you’re looking for. Having an HTML class that says what it is (e.g. class=”death-toll” on a <tr> element) isn’t the only setup that would let you scrape the data easily; if every pandemic page had a 100% consistent set of metadata, which was always provided in the same order (and listed as “N/A” or something if there was no known value), you might be able to reliably use something like <code class="docutils literal notranslate"><span class="pre">tr:nth-of-type(n+3)</span></code> in your scraper if you could count on the death toll always being the third element in that sidebar. But in reality, very few websites use either totally consistent metadata, or semantic classes on their elements. In most cases, for the results to be usable, web scraping is just a prelude to lots and lots of data cleaning.</p>
<p><img alt="Wikipedia's fake metadata structure" src="_images/dscm3_fake_metadata_structure.png" /></p>
<p>But <a class="reference external" href="http://fandom.com">fandom.com</a> wikis make our lives easy! Here’s the elements I created for all the data I wanted to capture; all of them are <em>Text</em> type and only <em>wikipagetext</em> (the body text on the wiki page) has the “multiple” boxes selected, because there’s usually multiple paragraphs of text on a wiki page:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Element name</p></th>
<th class="head"><p>Selector</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>booktitle</p></td>
<td><p>h1.page-header__title</p></td>
</tr>
<tr class="row-odd"><td><p>bookseries</p></td>
<td><p>[data-source=’series’] div</p></td>
</tr>
<tr class="row-even"><td><p>booknumber</p></td>
<td><p>[data-source=’no. in series’] div</p></td>
</tr>
<tr class="row-odd"><td><p>bookauthor</p></td>
<td><p>[data-source=’author’] div</p></td>
</tr>
<tr class="row-even"><td><p>bookcoverart</p></td>
<td><p>[data-source=’illustrator’] div</p></td>
</tr>
<tr class="row-odd"><td><p>booktagline</p></td>
<td><p>[data-source=’tagline’] div</p></td>
</tr>
<tr class="row-even"><td><p>publication</p></td>
<td><p>[data-source=’date’] div</p></td>
</tr>
<tr class="row-odd"><td><p>wikipagetext</p></td>
<td><p>.mw-content-ltr &gt; p</p></td>
</tr>
</tbody>
</table>
<p>Now, if you want to make your life easier, omit the <em>wikipagetext</em> element. What I initially wanted to get out of it was the “Dear Reader” section for the books that have it (e.g. what is the wholesome, relatable message at the end of <em><a class="reference external" href="https://babysittersclub.fandom.com/wiki/Stacey%27s_Big_Crush">Stacey’s Big Crush</a></em>, where she has a crush on a student teacher?), but there’s no HTML class to indicate that section, and it’s not like the book synopses are reliably 5 paragraphs long, so that you could count on “Dear Reader” being the 6th. But because this element has multiple values, and each one gets saved as its own row in the output file, it’s going to be a pretty gross data-hairball.</p>
<p>Once you’ve set this up, run the scraper, download the results, and you’ve got a brand new Ghost Cat data-hairball to clean up in OpenRefine… in addition to all those records from the various national libraries.</p>
</div>
</div>
<div class="section" id="got-ghost-cat-data-hairballs-call-openrefine">
<h3>Got Ghost Cat Data-Hairballs? Call OpenRefine.<a class="headerlink" href="#got-ghost-cat-data-hairballs-call-openrefine" title="Permalink to this headline">#</a></h3>
<p>When you need to clean up metaphorical data-hairballs from an imaginary Ghost Cat, you need a tool with a fairytale story. <a class="reference external" href="https://openrefine.org/">OpenRefine</a> started life as Freebase Gridworks, became Google Refine when its parent company was acquired, and then when Google stopped supporting it, it became an open-source project called OpenRefine, and, in 2019, got $200,000 from the Chan Zuckerberg (yeah, <em><a class="reference external" href="https://en.wikipedia.org/wiki/Mark_Zuckerberg">that Zuckerberg</a></em>) Initiative to fund its development in 2020 as “Essential Open Source Software for Science”. And while they don’t use a Humanities-inclusive Wissenschaft definition of “science”, I’m inclined to agree: OpenRefine has been essential for a lot of my computational text analysis work.</p>
<p>Download and install the software as you usually would, <a class="reference external" href="https://openrefine.org/">from their website</a>. If you’re on a Mac, you’ll have to deal with the “Unidentified developer” warning message; just Ctrl+click on the OpenRefine icon and open it from the menu that appears in order to bypass that.</p>
<p>For the Ghost Cat data-hairballs we’re working with here, the default settings for OpenRefine should be fine, but once you get into the thousands or hundreds of thousands of records, using OpenRefine will be torture if you don’t <a class="reference external" href="https://github.com/OpenRefine/OpenRefine/wiki/FAQ:-Allocate-More-Memory">increase the software’s memory allocation</a>.</p>
<p>One funny thing about OpenRefine is that you launch it as an application, but what it does is open a browser tab. At least once a week, I can see the OpenRefine diamond icon among my open applications, but for the life of me I can’t find the tab it’s running in – or maybe I closed it – so I shut it down and restart it to launch a new tab. When it launches, the tab it opens takes you to an interface for creating a new project by importing a file. Let’s start by uploading the file we just downloaded from <a class="reference external" href="http://webscraper.io">webscraper.io</a>, with all the information from the BSC fan wiki.</p>
<p>After you upload it, there’s a screen where you can configure the import. It makes its best guesses, but those can be hit or miss. If yours looks wonky, make sure that the option is selected for columns to be separated by commas:</p>
<p><img alt="Importing a CSV into OpenRefine" src="_images/dscm3_import_csv.png" /></p>
<p>Once you’re happy with the preview, click the “Create project” button in the upper right. This takes us to the regular OpenRefine screen.</p>
<div class="section" id="step-1-getting-one-row-per-book-from-the-fan-wiki-data">
<h4>Step 1: Getting One Row Per Book from the Fan Wiki Data<a class="headerlink" href="#step-1-getting-one-row-per-book-from-the-fan-wiki-data" title="Permalink to this headline">#</a></h4>
<p>You may notice that the lines in the file that you uploaded seem to be in a random order: <a class="reference external" href="http://webscraper.io">webscraper.io</a> doesn’t scrape in the order you might expect, in alphabetical order like you specified. We’ll start by sorting by the URL of each page you scraped data from. Click the downward-facing arrow next to the <em>bookurl</em> column header, and choose “Sort” then “OK” in the box that pops up. Now your results are clustering by the book they’re associated with (starting with <em>Abby and the Best Kid Ever</em>), but if you look at the third column from the left, you can see that this view is just a display for your benefit: the data itself hasn’t been re-sorted. We can change that by clicking on the down arrow next to Sort above the cells, and choosing “Reorder rows permanently”. This changes the row numbers associated with <em>Abby and the Best Kid Ever</em> to 1-7.</p>
<p><img alt="Reordering rows in OpenRefine" src="_images/dscm3_reorder.png" /></p>
<p>Having the data permanently reordered this way makes it possible for us to clean up one part of this hairball: the fact that there’s a row for every single paragraph of text on the wiki page, and all of those rows are identical except for the initial web-scraper-order column and the final <em>wikipagetext</em> column. What we want here is to merge all of those paragraph-cells into a single cell, with a single row for each book.</p>
<p>First, delete the <em>web-scraper-order</em> column by hitting the arrow to the left of its name and choosing <em>Edit column &gt; Remove column</em>. You can also delete the* web-scraper-start-url* column, which is the same for all the rows, and the <em>bookurl-href</em> which should be redundant with <em>bookurl</em>.</p>
<p>Next, what we need to do is called “Blank down”. When you have a bunch of rows next to one another that repeat data in almost all of their cells, blank down deletes the repetitions. Click on the arrow to the left of <em>every column name</em> except for <em>wikipagetext</em>, and choose <em>Edit cells &gt; Blank down</em>. The first instance of each value in a column will stay; every subsequent one will be removed. (Note: this only works if the rows are ordered so that repeated column values are all grouped together.)</p>
<p>When you’re done, you should have a completely filled-in row, followed by a set of rows that are blank except for the <em>wikipagetext</em> column, followed by another completely filled-in row for another book – and so on. Now for the magic: click the arrow to the left of the <em>wikipagetext</em> header and choose <em>Edit cells &gt; Join multi-valued cells</em>. A window will pop up where you can select the separator; replace the default comma with a space. This will get you the output you’re looking for: a single row per book, with the full text from the wiki page in the final cell.</p>
<p>What we’re ultimately going to want to do is add columns to the wiki spreadsheet that we just cleaned up, for information from the data that Lee gathered from the national libraries. But before we combine the national library data with the wiki data, we need to clean up the national library data.</p>
</div>
<div class="section" id="step-2-clean-up-quebec-data">
<h4>Step 2. Clean up Quebec data<a class="headerlink" href="#step-2-clean-up-quebec-data" title="Permalink to this headline">#</a></h4>
<p>What Lee sent me from Quebec was a series of CSVs, one per year (1990-1996). There’s lots of ways you can combine those files, the most obvious– if rather inefficient– method being copying and pasting the content (minus the headers) from all the files into a single file. However you choose to do it, load the resulting CSV file into OpenRefine as a new project. If the default settings don’t pick up the use of a semicolon as the separator, you’ll need to manually configure that under “Columns are separated by” by choosing “Custom separator” and putting in a semicolon. You’ll also need to uncheck “Parse next 1 line(s) as column headers”. Then click “Create project”, in the upper right of the interface.</p>
<p>The first record (“Bienvenue, Marjorie!”, if you’re using the data file in our GitHub repo) will be a little messed up – split between two rows. The fastest way to fix this is to copy and paste the values into the right places, then delete the erroneous second row. If you hover over a cell, a blue “edit” button appears in the upper right of that cell, and you can use that to both copy and paste text.</p>
<p>Keeping an eye on the end goal of being able to sync up this spreadsheet with the wiki data, we need one column that has the unique ID for each book. In this case, it’s column 5, which looks like “Les baby-sitters ; 15”; what we need to do is replace the first part with nothing, leaving us just the number. Hit the arrow in the header for that column, then choose <em>Edit cells &gt; Replace</em> and replace “Les baby-sitters ; ” with nothing.</p>
<p>We also need to remove all the “Baby Sitter’s Little Sister” books; click the arrow in the header for the same column that previously had “Les baby-sitters”, choose <em>Text filter</em>, and put in “Le Petit monde de Karen”; this gave me 6 rows, and I deleted them by hitting the arrow to the left of “All” (the column header furthest to the left), and choosing <em>Edit rows &gt; Remove matching rows</em>. This will give you a blank screen of results; delete the text filter in the left column by hitting the X, and you’ll be back to the remaining rows.</p>
<p>Next, we need to normalize the series number for Super Specials, Mysteries, and Portrait books. Hit the arrow to the left of the column that previously had “Les baby-sitters”, and choose <em>Facet &gt; Text facet</em>. This will open a new facet on the left with every unique value in that field. Using that, we can see that all the Super-Special books start with “Les baby-sitters. Super spécial ; no ” and all the Mysteries start with “Les baby-sitters. Mystère ; no “. We can do the same thing – <em>Edit cells &gt; Replace</em> – and replace the text associated with Super-Specials with “SS” and the Mystery text with “M”. (You’ll have to do this twice for the Super-Specials, because the data isn’t completely consistent. All but one use “<em>Les baby-sitters. Super spécial ; no</em> ” and one omits the “no”.) There’s one “Les baby-sitters. Collection Portrait”; just manually change it to “P2” (Claudia’s book was the second one published). If you hover over the text in the facet, you’ll see an “edit” option pop up, and you can edit the text directly from the facets.</p>
<p>Let’s revisit the list of things we want out of this data:</p>
<ol class="simple">
<li><p>The <em>translated title</em> of the book: we have this in column 1, before the /</p></li>
<li><p>A <em>unique identifier</em> to connect back to the original book (book number, title, etc.): we have this now in column 5 after doing the clean-up</p></li>
<li><p><em>Which translation series is it in</em> (e.g. for French: Quebec, Belgian, or France): we know this because of the source of the data</p></li>
<li><p><em>The date it was published</em>: this is in column 3, but we need to extract it from the other data there</p></li>
<li><p><em>The translator</em>: we have this in column 8, but we should clean it up</p></li>
</ol>
<p>To get the data we want for the translated title, use the <em>Edit Cells &gt; Replace</em> function for column 1, and check the “Regular expression” box. In the first box, put:  <code class="docutils literal notranslate"><span class="pre">(.*)</span> <span class="pre">\/</span> <span class="pre">(.*)</span></code> and in the second, <code class="docutils literal notranslate"><span class="pre">$1</span></code>. This looks for all characters (letters, numbers, etc.) before a slash, and all the characters after a slash, and replaces all the text with just the characters before the slash. (Yeah, I had to double-check that with a regular expression tester before I used it.)</p>
<p>For the publication date, we need to do the same thing in column 3, but with <code class="docutils literal notranslate"><span class="pre">(.*)([0-9]{4})(.*)</span></code> in the first box (which looks for the text before the occurrence of 4 numbers, the 4 numbers, and after the 4 numbers), and <code class="docutils literal notranslate"><span class="pre">$2</span></code> in the second (which replaces the text with just the numbers, which in this case represents a date.) Don’t forget to check the “Regular expression” box or it won’t work!</p>
<p>For the translator (column 8), use <em>Edit Cells &gt; Replace</em> and replace <code class="docutils literal notranslate"> <span class="pre">,</span> <span class="pre">trad.</span></code> with nothing.</p>
<p>Now, we can delete every column except for 1, 3, 5, and 8.</p>
<p><img alt="Missing value in Quebec data" src="_images/dscm3_missing_quebec_value.png" /></p>
<p>Notice anything? We’ve caught a metadata inconsistency on the part of some librarians in Montreal! The translator column is empty for <em>Les baby-sitters en vacances d’hiver</em>! Is the data missing, or just misplaced? By going back to the original file that Lee downloaded, I was able to find that the info was present in column 1 before we cleaned it up: the person who “adapted it from the American” was Sylvie Prieur. So let’s fill that in manually in the translator column before moving on.</p>
<p>With the data all cleaned up like this, we can go to <em>Facet &gt; Text facet</em> for the translator column to discover that, according to the data we have, there were 4 Quebec translators: Nicole Ferron did the most (24), Marie-Claude Favreau and Sylvie Prieur each did 16, and Lucie Duchesne did 12. If we choose <em>Text filter</em> for the column that has the book numbers, and put in “SS” as the value, we see that no one seemed to specialize in the super-specials, but if we put in “M”, we find that almost half of Lucie Duchesne’s contributions (5 out of 12) were in the mystery sub-series.</p>
</div>
<div class="section" id="step-3-clean-up-the-data-from-the-french-national-library">
<h4>Step 3. Clean up the data from the French National Library<a class="headerlink" href="#step-3-clean-up-the-data-from-the-french-national-library" title="Permalink to this headline">#</a></h4>
<p>The data Lee exported from the French National Library includes both the books published in France, and the Belgian translations. When you import the French metadata, OpenRefine parses the file correctly by default, and you can go ahead and create the project.</p>
<p>The French metadata includes a record for every copy the library has, so there’s duplicates to eliminate first. Sort the records by the second column, “n° notice BnF”, then in that column, go to <em>Edit cells &gt; Blank down</em>. For that column again, go to <em>Facet &gt; Customized facets &gt; Facet by blank</em>. In the filter on the left, choose “true” (i.e. blank). Then, when you’re viewing only the rows that are blank click the arrow next to “All” and go to <em>Edit rows &gt; Remove matching rows</em>.</p>
<p>To make it simpler to get to see data that we want, let’s delete some unnecessary columns: <em>Type de notice, Type de document, Localisation, Exemplaire n°, Sujet, Couverture, Langue, Format</em>, and the blank final column.</p>
<p>It looks like the <em>Auteur</em> column has the translator information. We could try to get to it by splitting the values in that column (by using <em>Edit column &gt; Split into several columns</em>, using the | character as the separator), but if you start down that road, you’ll discover that sometimes the translator doesn’t get marked in that field, but the translator seems to be more reliably available through the Titre column. Also, the Auteur column doesn’t differentiate contributor role (e.g. translator vs. illustrator), and you’d need to cross-check with the <em>Titre</em> column anyway to identify the correct translator. So let’s work from the <em>Titre</em> column instead.</p>
<p>For the <em>Titre</em> column, go to <em>Edit column &gt; Split into several columns</em> using the semicolon as the separator. The resulting “Titre 1” will have the book column and (in most cases) Ann M. Martin. “Titre 2” mostly has translators, with a few illustrators and other kinds of authors (e.g. “a comic strip by Raina Telgemeier”). Only one row in “Titre 3” and two rows in “Titre 4” have a translator. For each of these columns, delete the values that don’t include a translator. The easiest way to do this might be to do <em>Facet &gt; Text facet</em> for each column, and edit the ones that aren’t a translator (by hovering over the value in the sidebar facet, and clicking “edit”, and deleting the value). Once <em>Titre 2-4</em> are all just translators, go to <em>Titre 2</em> and go to <em>Edit column &gt; Join columns</em>. Check the boxes for <em>Titre 3</em> and <em>Titre 4</em>, and choose the semicolon as the separator. Once you’ve merged all values into <em>Titre 2</em>, you can delete Titre 3-4. Next, it’s time to clean up <em>Titre 2</em>, which now has all the translator information. Do <em>Facet &gt; Text facet</em> and use <em>Edit cells &gt; Replace</em> to replace all the variations on “translated by” (e.g. “trad. de l’anglais par”, “trad. de l’américain par”, “traduit de l’anglais (États-Unis) par”) along with extraneous punctuation like “]; ;” until the values in that field coalesce (i.e. until you have more rows sharing the same translator value, without extraneous variation like how “translated by” was written). Another way to reduce variation is by going to <em>Edit cells &gt; Common transforms &gt; Trim leading and trailing whitespace</em>. One other check you can do is go to <em>Edit cells &gt; Cluster and edit</em>. Under the “method” drop-down, choose “nearest neighbor”. This may turn up discrepancies, for instance, like the addition of an extra “l” to Camille Weil’s name in one record:</p>
<p><img alt="Clustering values" src="_images/dscm3_cluster_and_edit.png" /></p>
<p>Check the box for “Merge”, then choose “Merge selected and close”.</p>
<p>How close are we now? Go to <em>Titre 2</em> and do <em>Facet &gt; Customized facet &gt; Facet by blank</em>.</p>
<p>Oof. 42 books without a translator listed. 11 Belgian books (if you do a text facet on Editeur, the Belgian ones are “Chantecler (Aartselaar)”), 31 France books.</p>
<p>Can we salvage this by looking for the data in other columns? If you add a text filter on the Contributeur column and search for “trad”, there’s 2 rows that have (multiple) translators in the <em>Contributeur</em> column, who didn’t appear in the Titre column, for some of the text compilations (i.e. books that contain multiple original books). Unfortunately, you can’t tell from this how to map the translators to the individual books, so for our purposes, metadata from text compilations is pretty useless.</p>
<p>When I get stuck on one aspect of data cleaning, sometimes it helps to put it down for a bit and work on another part of the file. We know that the file that we’re working with is everything by Ann M. Martin in the French National Library, so there’s non-BSC stuff in here too. The series information seems to be in the <em>Description</em> field, where it exists. Let’s do a <em>Text filter</em> there to search for “La petite soeur des baby-sitters” (the Belgian “Baby-Sitter’s Little Sister”), then remove all matching rows. What we really want is to remove all non-BSC books, and then extract the series number from the <em>Description</em> field. But looking more closely through the data, not all the records have the series number, which is going to make a mess when we try to merge this data with our original English metadata. This is the moment where we realize that this Ghost Cat is also having digestive problems, in addition to its hairballs. We’ve got to lock it in the bathroom before we’re left scrubbing down the whole house.</p>
<p>So what gives? Is the data actually not there? Or is it just not in the download that Lee got?</p>
<p>The <em>Identificat</em> column contains the URL of the catalog record, along with the ISBN number. The ISBN number doesn’t help us any, so let’s go to <em>Edit cells &gt; Replace</em>, check the box for regular expression, and put in <code class="docutils literal notranslate"> <span class="pre">.*</span></code>, which will select everything that occurs after the first space (which appears after the catalog record URL. Replace with nothing. This should get you valid, clickable URLs for each of the entries.<br />
The records where the description starts with “Collection : (Folio junior” are our problem: no series number, and no other way to try to link back to the original English (like the original English title). Let’s check out <a class="reference external" href="https://catalogue.bnf.fr/ark:/12148/cb367080517">Mallory entre en scène</a>… and there it is. We’ve got both “Traduction de: Hello, Mallory” and “Titre d’ensemble : (Le club des baby-sitters. ; 14)” in the catalog record.</p>
<p><img alt="BNF catalog record" src="_images/dscm3_bnf_catalog.png" /></p>
<p>But if you try to export search results from the catalog, those fields aren’t available.</p>
<p><img alt="BNF catalog export" src="_images/dscm3_public_export.png" /></p>
<p>But wait! What about that <em>paramétrage professionnel</em> tab?</p>
<p><img alt="BNF professional catalog export" src="_images/dsc_m3_professional_export.png" /></p>
<p>Intermarc? Unimarc? I know about the <a class="reference external" href="https://en.wikipedia.org/wiki/MARC_standards">MARC standards</a> for library cataloging, and I have a piece of paper lying around here saying that I’m officially certified as a Library and Information Scientist, but … ugh.</p>
<p>But then I thought about Arcadia Falcone, the metadata librarian at work and one of the most quirky-cool people I know. She’d probably know the MARC codes I needed for these records off the top of her head, and could figure out Unimarc with both hands busy crocheting an amazing shawl. I could do this, too. And thanks to the Library of Congress, it wasn’t actually too bad; there’s a “<a class="reference external" href="https://www.loc.gov/marc/unimarctomarc21.html">UNIMARC to MARC 21 Conversion Specifications</a>” that was published only 9 months after the last Baby-Sitters Club book. The formatting alone suggests a promising treatment for insomnia– try it the next time nightmares wake you up in the middle of the night! (I can’t be the only one with that problem these days…)</p>
<p><img alt="Unimarc to MARC21" src="_images/dscm3_unimarc_marc21.png" /></p>
<p>Searching for “translation” scored me 453 for the field with the English title of the book, and searching for “series” got me 225 for the field with the book number (even better than the English book title). I stuck “225;” into the field, hit Exporter, and held my breath.</p>
<p>What I got was an ExportPro.csv file, with the fields “Identifiant ARK”, “N° notice BnF”, “Type de notice”, “Type de document;=”225””. The spreadsheet I’d already partly cleaned in OpenRefine had that “N° notice BnF” field, too, as a unique value for each book – all I needed to do was connect my new data with my old OpenRefine project using that “N° notice BnF” value to match everything up. Time for another metadata librarian to the rescue! <a class="reference external" href="https://ruthtillman.com/">Ruth Kitchin Tillman</a> recently did an <a class="reference external" href="https://ruthtillman.com/talk/cell-cross-webinar-2020-03/">online OpenRefine workshop on “cell cross”</a>, which is the OpenRefine jargon for doing exactly what we need to do here. It’s worth watching for a more detailed explanation, but uses a library cataloging example that might not be as relevant to Data-Sitters Club readers, so let’s run through it here.</p>
</div>
<div class="section" id="look-both-ways-before-crossing-the-cells">
<h4>Look both ways before crossing the cells<a class="headerlink" href="#look-both-ways-before-crossing-the-cells" title="Permalink to this headline">#</a></h4>
<p>The first step is to create a new OpenRefine project with our ExportPro.csv that has the series numbers. If you still have the earlier OpenRefine project from the French National Library open, you can open up a new OpenRefine tab by right-clicking on the logo in the upper left, and choosing “Open link in new tab”. Import the ExportPro.csv file, and call the new project “ExportPro”; the defaults are mostly fine, but uncheck the “Use character ” to enclose cells containing column separators” option. The column that we want to import has a name that might cause some errors (it includes quotation marks, which are often a problem in file and column naming). Rename the last column “value225”.<br />
Now, go back to the earlier project with the French National Library data. Go to the “N° notice BnF” column and choose <em>Edit column &gt; Add column</em> based on this column.</p>
<p><img alt="Adding a column for cell cross" src="_images/dscm3_cell_cross.png" /></p>
<p>In the box that pops up, we’ll call the new column “seriesnumber”. The syntax here is a little tricky, but roughly follows the format <code class="docutils literal notranslate"><span class="pre">cell.cross(“Other-Project”,</span> <span class="pre">“Column-to-Match-in-Other-Project”])[0].cells[Column-to-Import-from-Other-Project].value</span></code>. So in this case, the other project (the one we just created from ExportPro.csv) is called ExportPro, the column there that we want to match against is “N° notice BnF”, and the column we’re trying to import is called “value225”: <code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;ExportPro&quot;,</span> <span class="pre">&quot;N°</span> <span class="pre">notice</span> <span class="pre">BnF&quot;)[0].cells[&quot;value225&quot;].value</span></code>.</p>
<p><img alt="Cell cross data preview" src="_images/dscm3_cell_cross_detail.png" /></p>
<p>Success! Once you’ve finished the cell cross, you can close the ExportPro OpenRefine project. All we need to do now is clean up the “seriesnumber” field. It’s easiest to start by doing <em>Facet &gt; Text facet</em> on the “seriesnumber” field, to get a sense of how much progress you’re making in your cleaning. Replace <code class="docutils literal notranslate"><span class="pre">225$aLe</span> <span class="pre">club</span> <span class="pre">des</span> <span class="pre">baby-sitters.$v</span></code>, <code class="docutils literal notranslate"><span class="pre">225$aLe</span> <span class="pre">club</span> <span class="pre">des</span> <span class="pre">baby-sitters.$v</span></code>, <code class="docutils literal notranslate"><span class="pre">225$aLe</span> <span class="pre">club</span> <span class="pre">des</span> <span class="pre">babysitters$v</span></code>, and <code class="docutils literal notranslate"> <span class="pre">&amp;#124;</span> <span class="pre">225\$aFolio</span> <span class="pre">junior\$v(.*)</span></code> (the broader “Folio junior” publication series) with nothing.</p>
<p>There are 18 records that just have the series “225<span class="math notranslate nohighlight">\(aLe club des baby-sitters&quot;; these are the text collections (&quot;Nos dossiers top-secret&quot;, &quot;Nos plus belles histoires de coeur&quot;, etc.) that have multiple books in one. Because we can't disambiguate who translated which of the sub-books, these records aren't very helpful for us; you can delete them all by choosing the facet &quot;225\)</span>aLe club des baby-sitters”, then going to the <em>All</em> column and choosing <em>Remove matching rows</em>. Do the same for the records with the “225<span class="math notranslate nohighlight">\(aFolio junior&quot; facet, which seem to represent series (like the mysteries, or comic books). You can also delete the record in the &quot;225\)</span>aFolio junior<span class="math notranslate nohighlight">\(v950&quot; facet (not a BSC book), and the records with blank values for &quot;seriesnumber&quot; (more series records or not BSC books). This leaves us with a set of mystery entries. Replace `225\)</span>aLe club des baby sitters mystère.<span class="math notranslate nohighlight">\(v` and `225\)</span>aLe club des babysitters<span class="math notranslate nohighlight">\(iMystère\)</span>v<code class="docutils literal notranslate"><span class="pre">with</span></code>M`.</p>
<p>Can we pause for a second and reflect on what it means to have to replace two different values for the mystery books, or three for the main series? Yeah, it’s more work, and that’s kinda annoying, but when I see things like that, it’s a reminder that these records were created by people (and more likely than not, <em>women</em>). It’s easy to treat a giant national library catalog with export functionality and millions upon millions of records as something digital, computerized, consistent – but those records were originally created by people. People who might still be walking around in the world (or, at this present moment, hopefully sheltering-in-place at home). Who are they? What are their lives like? Do they have family members who are sick? Are they in a hospital, with a complex constellation of factors determining whether they’ll be one of the lucky ones who gets a ventilator? Think about that, next time you’re using an online catalog to access digital resources. Real people made these records. And other real people did real work to convert them into the form that you’re using. Pause for a moment to think of those people. And maybe send a thank-you note or cupcakes or flowers or something to your local library’s technical services staff from time to time, once this is over.</p>
</div>
<div class="section" id="a-little-more-tidying">
<h4>A little more tidying<a class="headerlink" href="#a-little-more-tidying" title="Permalink to this headline">#</a></h4>
<p>Let’s finish cleaning up these BNF records and get ready to import them back into our master metadata spreadsheet. We just want the translated book titles in the “Titre 1” column, not Ann M. Martin’s name, so replace <code class="docutils literal notranslate"> <span class="pre">/</span> <span class="pre">Ann</span> <span class="pre">M.</span> <span class="pre">Martin</span></code> with nothing.</p>
<p>We also need to make sure there’s only one instance of each “seriesnumber” value, otherwise the cell cross won’t work. Go to <em>Facet &gt; Text facet</em> for “series number”, and sort by “count” at the top of the facet list.</p>
<p><img alt="Series number facet" src="_images/dscm3_seriesnumber_facets.png" /></p>
<p>Uh-oh. We have <em>up to 5</em> instances of some of these series numbers. Let’s dig into it.</p>
<p>It’s not shocking to get two copies: we have both Belgian and French data here. (We’ll need to export the Belgian data and set it up as its own project for a cell cross, but no big deal.)</p>
<p>What to do about the French data? Clicking through some examples, it looks like it’s coming down to the question of reprints. Now, a book history of the Baby-Sitters Club in French would be fascinating! But remember what I said… um… some 20 pages ago at this point? “Sometimes the hardest part of DH is setting aside all the things you <em>could do</em>, to finish the thing that you’re <em>actually doing</em>.” When I listed “publication date” as one of the things I wanted to get… well, given the choice of multiple dates, I want the first one. Reprints? You all gotta go.</p>
<p>I clicked through the facets; they’re already sorted in a way that works out to be chronological. Because the France-French versions were published after the Belgian ones (which didn’t have reprints), we can go to the “Editeur” column and choose <em>Edit cells &gt; Blank down</em>*. This removes the “Editeur” field for everything except the Belgian version and the first French version. Do this for each “seriesnumber” facet (e.g. first click on 1, then on 2) with more than 2 values. (“But Quinn,” you might object. “Isn’t that rote work? Aren’t you letting the Ghost Cat win? Couldn’t you script that?” To which I would reply, “Look, it’s fewer than 20 facets, I’m tired, let’s just go clicky-clicky and be done with it, all right?”) As you’re doing it, though, pay attention to the book titles: if there’s anything that looks radically different than the other translated titles, Google it to make sure that the series number is right. Notably, “La revanche de Carla” appears along with variations on “Bienvenue, Marjorie!”; it should be book 15, not 14. It’s also worth going a step further and checking that the facets with 2 values have them from different publishers; for instance, the BNF catalog has two records from France for book #4 “Pas de panique, Mary Anne”, and no record for the Belgian equivalent “Mélanie garde la tête froide”.</p>
<p>Now, close the “seriesnumber” facet and go to <em>Facet &gt; Text facet</em>* for the “Editeur” column. Click the “(blank)” facet, and under <em>All</em>, choose <em>Edit rows &gt; Remove matching rows</em>. If you want to double-check your work, if you click either the “Chantecler (Aartselaar)” or the “Gallimard jeunesse (Paris)” facet, and add the “seriesnumber” facet, each “seriesnumber” facet should only appear with 1 value.</p>
<p><img alt="Clean series number facet" src="_images/dscm3_facets_clean.png" /></p>
<p>Close the “seriesnumber” facet, but keep the “Editeur” facet open, and select “Chantecler (Aartselaar)”. In the upper right corner of the OpenRefine interface, go to <em>Export &gt; Comma-separated value</em>. This will give you a new CSV file with just the Belgian records; you may want to rename it <code class="docutils literal notranslate"><span class="pre">bnf_records_belgian.csv</span></code> just to keep things clear. With that data exported, you can delete the Belgian records from your current OpenRefine project by going to <em>All &gt; Edit rows &gt; Remove matching rows</em>.</p>
<p>Once again, create a new OpenRefine project, this time for the Belgian records you just exported. Import the CSV file you just exported (bnf_records_belgian.csv, if you renamed it). You shouldn’t have to do any additional cleaning on it – it should just be ready to go.</p>
</div>
</div>
<div class="section" id="step-4-revisiting-the-fan-wiki-data">
<h3>Step 4. Revisiting the fan wiki data<a class="headerlink" href="#step-4-revisiting-the-fan-wiki-data" title="Permalink to this headline">#</a></h3>
<p>Before we combine the fan wiki data with the records from the national libraries, we need to do a little more cleanup. Go to <em>Facet &gt; Text facet</em> for the “booknumber” column. There shouldn’t be more than one value for each of the facets, but some of them have multiple values (e.g. “Kristy’s Great Idea” – the very first book – and “Baby-sitters on Board!” – the first Super Special book, both are listed under 1.) If you add a text facet for the “bookseries” column, you can do some bulk editing. For instance, if you select the “The Baby-Sitters Club Mystery” facet under “bookseries”, you can do <em>Edit cells &gt; Replace</em> and replace <code class="docutils literal notranslate"><span class="pre">^</span></code> with <code class="docutils literal notranslate"><span class="pre">M</span></code> (make sure you check the “regular expressions” checkbox) to put an M at the beginning of all the mystery books. Super-special books should similarly be prefixed with “SS”, Reader’s Request should be “RR”, Super Mysteries are “SM”, Portrait Collection are “PC”, Friends Forever are “FF”, and California Diaries are “CD”. (We just made up these conventions, but they are how we actually name the files in our corpus.)</p>
<p>Once no facet other than “null” has more than one value, you’re ready to bring in the data from the national libraries.</p>
</div>
<div class="section" id="step-5-the-ultimate-cell-cross-of-ultimate-destiny">
<h3>Step 5. The Ultimate Cell-Cross of Ultimate Destiny<a class="reference external" href="#footnote">*</a><a class="headerlink" href="#step-5-the-ultimate-cell-cross-of-ultimate-destiny" title="Permalink to this headline">#</a></h3>
<p>We’ve got four OpenRefine projects open now:</p>
<ul class="simple">
<li><p>Bsc_book_metadata: data scraped from the fan wiki</p></li>
<li><p>Quebec_records: metadata for books published in Quebec</p></li>
<li><p>Bnf_records: metadata for books published in France</p></li>
<li><p>Bnf_records_belgian: metadata for books published in Belgium</p></li>
</ul>
<p>In Bsc_book_metadata, go to the “booknumber” column and choose <em>Edit column &gt; Add column based on this column</em>. You’ll need to do this once for each of the rows in the following table, which spells out what the new column should be called (which should be a good indicator of the data that you’re pulling in), and the cell cross formula you need to get it.</p>
<p>You may see a lot of error messages in the previewed results – that’s okay. We have over 200 rows for metadata scraped from the fan wiki, and only 80 rows from Quebec (and fewer still from Belgium and France). To increase the likelihood that you’ll see results, you can re-sort the fan wiki data by the “booknumber” column, since earlier books were more likely to be translated.</p>
<p><img alt="Cell cross missing values" src="_images/dscm3_ultimate_cell_cross_errors.png" /></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>New column</p></th>
<th class="head"><p>Cell cross formula</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QuebecTitle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;quebec_records&quot;,</span> <span class="pre">&quot;Column</span> <span class="pre">5&quot;)[0].cells[&quot;Column</span> <span class="pre">1&quot;].value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>QuebecDate</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;quebec_records&quot;,</span> <span class="pre">&quot;Column</span> <span class="pre">5&quot;)[0].cells[&quot;Column</span> <span class="pre">3&quot;].value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>QuebecTranslator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;quebec_records&quot;,</span> <span class="pre">&quot;Column</span> <span class="pre">5&quot;)[0].cells[&quot;Column</span> <span class="pre">8&quot;].value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>BelgiumTitle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records_belgian&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Titre</span> <span class="pre">1&quot;].value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>BelgiumDate</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records_belgian&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Date&quot;].value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>BelgiumTranslator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records_belgian&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Titre</span> <span class="pre">2&quot;].value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>FranceTitle</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Titre</span> <span class="pre">1&quot;].value</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>FranceDate</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Date&quot;].value</span></code></p></td>
</tr>
<tr class="row-even"><td><p>FranceTranslator</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cell.cross(&quot;bnf_records&quot;,</span> <span class="pre">&quot;seriesnumber&quot;)[0].cells[&quot;Titre</span> <span class="pre">2&quot;].value</span></code></p></td>
</tr>
</tbody>
</table>
<p>The last thing to do is to reorder the columns in a more sensible arrangement. Click the arrow next to “All”, and choose <em>Edit columns &gt; Re-order/remove</em>. We’ll re-order the columns so all the French fields are at the end.</p>
</div>
<div class="section" id="where-to-from-here">
<h3>Where to from here?<a class="headerlink" href="#where-to-from-here" title="Permalink to this headline">#</a></h3>
<p>Finally, we had our spreadsheet for English and French! All the books, all the ghostwriters, and many of the translators. The metaphorical Ghost Cat, curled up peacefully in our lap, purring. So much data brimming with possibility for answering new questions – but what should those questions be?</p>
<p>As we were wrapping up writing this book, I asked Lee to take a look at the “Dear Reader” section.</p>
<blockquote>
<div><p>From: Lee Skallerup Bessette</p>
</div></blockquote>
<blockquote>
<div><p>To: Quinn Dombrowski</p>
</div></blockquote>
<blockquote>
<div><p>Subject: Re: Dear Reader draft</p>
</div></blockquote>
<blockquote>
<div><p>Date: 3/28/20 10:45 AM</p>
</div></blockquote>
<blockquote>
<div><p>Yay! SOMETHING TO DO OTHER THAN LISTEN TO MY SON PLAY VIDEO GAMES AND MY DAUGHTER AND HUSBAND ARGUE.</p>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>From: Quinn Dombrowski</p>
</div></blockquote>
<blockquote>
<div><p>To: Lee Skallerup Bessette</p>
</div></blockquote>
<blockquote>
<div><p>Subject: Re: Dear Reader draft</p>
</div></blockquote>
<blockquote>
<div><p>Date: 3/28/20 10:46 AM</p>
</div></blockquote>
<blockquote>
<div><p>LOL! What do you want to do next?</p>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>From: Lee Skallerup Bessette</p>
</div></blockquote>
<blockquote>
<div><p>To: Quinn Dombrowski</p>
</div></blockquote>
<blockquote>
<div><p>Subject: Re: Dear Reader draft</p>
</div></blockquote>
<blockquote>
<div><p>Date: 3/28/20 11:17 AM</p>
</div></blockquote>
<blockquote>
<div><p>Weren’t we going to move on to the translation/adaptations of the comic books? I mean, we can comic TEI the snot out of them, and maybe this isn’t a mystery, but that sounds like a fun next step, at least on my end. You sent the French version(s) right? And the Quebec and France ones are the same, we think?</p>
</div></blockquote>
<blockquote>
<div><p>How does that sound?</p>
</div></blockquote>
<hr class="docutils" />
<p>It sounded great. We’ll take a break from these translations for now, and start exploring the new form of The Baby-Sitters Club that young people these days are reading. We’ll be getting into TEI  encoding, methods for image comparison, and whatever else we stumble upon on the way. We’ll be back soon with more. Until then, take care of yourself, dear reader, and those around you.</p>
</div>
</div>
<div class="section" id="suggested-citation">
<h2>Suggested citation<a class="headerlink" href="#suggested-citation" title="Permalink to this headline">#</a></h2>
<p>Bessette, Lee Skallerup and Quinn Dombrowski. “DSC Multilingual Mystery #3: Quinn and Lee Clean Up Ghost Cat Data-Hairballs”. April 2, 2020. <a class="reference external" href="https://datasittersclub.github.io/site/dscm3.html">https://datasittersclub.github.io/site/dscm3.html</a></p>
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<a name="footnote" />&#42; 
Am I the only one who's had strange, random music emerging from the corner of their brain after a couple weeks at home? I have no idea why this <a href="https://www.youtube.com/watch?v=wbKmETVWG64">12-year-old song</a> has gotten stuck in my head, but working on this final step, I can't help but re-imagine it, subbing out the Baby-Sitters Club, Sweet Valley High, American Girl Dolls, Cabbage Patch Kids, Rainbow Bright, My Little Ponies, and other differently-gendered references. Would Maria from Sesame Street emerge victorious -- perhaps by negotiating with the other iconic characters to work together instead of fighting, in order to ensure everyone has the resources they need to defeat COVID-19, from toilet paper to ventilators?
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="dscm2.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">DSC Multilingual Mystery 2: Beware, Lee and Quinn!</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="dscm4.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">DSC Multilingual Mystery 4: Isabelle and the Missing Spaghetti-O’s</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Data-Sitters Club<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>